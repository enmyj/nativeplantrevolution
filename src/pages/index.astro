---
import Layout from '../layouts/Layout.astro';
import SiteCard from '../components/SiteCard.astro';
import { getCollection } from 'astro:content';

const sites = await getCollection('sites');
const sortedSites = sites.sort((a, b) => {
	const dateA = a.data.plantedDate ? new Date(a.data.plantedDate).getTime() : 0;
	const dateB = b.data.plantedDate ? new Date(b.data.plantedDate).getTime() : 0;
	return dateB - dateA;
});
---

<Layout title="Gardens">
	<h1>Native Plant Gardens</h1>
	<p class="intro">
		Explore our growing collection of native plant gardens. Each site showcases the beauty 
		and ecological benefits of plants native to their region, creating vibrant habitats 
		for pollinators, birds, and other wildlife.
	</p>

	{sortedSites.length > 0 ? (
		<div class="grid">
			{sortedSites.map((site) => (
				<SiteCard
					title={site.data.title}
					address={site.data.address}
					description={site.data.description}
					image={site.data.images[0]}
					slug={site.id.replace(/\.md$/, '')}
				/>
			))}
		</div>
	) : (
		<p class="empty">No gardens have been added yet. Check back soon!</p>
	)}
</Layout>

<style>
	.intro {
		color: var(--color-text-muted);
		max-width: 700px;
		margin-bottom: 2.5rem;
		font-size: 1.1rem;
	}

	.grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
		gap: 1.5rem;
	}

	.empty {
		color: var(--color-text-muted);
		font-style: italic;
		padding: 3rem;
		text-align: center;
		background: var(--color-surface);
		border: 1px solid var(--color-border);
		border-radius: 12px;
	}
</style>
